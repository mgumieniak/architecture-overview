Architecture

When number brokers >= 3 
Apply TODO changes